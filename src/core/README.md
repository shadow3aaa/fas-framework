* 此处为核心逻辑部分